{% load static %}

<!DOCTYPE html>
<html lang="en">
	
	<head>
		<meta charset="UTF-8">
		<title>SIGN UP</title>
		<link rel="stylesheet" type="text/css" href="{% static '/css/signup.css' %}">
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudfare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">	

	</head>

	<body>

		<div class="center">

			<h1>Sign Up</h1>
			
			<form action="/home/postsignUp/" method="post" >
			
				<div id='captcha'></div>
				{% csrf_token %}
	
				<div class="row">
	
					<div class="column">
						
						<!--Name: -->
						<div class="txt_field">
							<select type="text" class = "drop_down" style = "width: 130px; height: 39px" value="Salutation" name=""  required>
								<option value="" disabled selected hidden>Salutation</option>
								<option>Ms.</option>
								<option>Mr.</option>
								<option>Mrs.</option>
	
							</select>  
	
						</div>
	
						<!--MiddleName: -->
						<div class="txt_field">
							<input type="MiddleName" id="MiddleName" name="MiddleName" placeholder="Middle Name" required>
							<span></span>
						</div>
	
						<!-- Email: -->
						<div class="txt_field">
							<input type="email" id="Email" name="email" placeholder="Email Id" oninvalid= "InvalidMsg(this);" oninput = "InvalidMsg(this);" required = "required"/>
							<span></span>
						</div>

						<!--Employment Type: -->
						<div class="txt_field">
							<input type="employment_type" id="Employment Type" name="employment_type" placeholder="Employment Type" required>
							<span></span>
						</div>

						<!-- Password: -->
						<div class="txt_field">
							<input type="password" id="Password" name="password" placeholder="Password" oninvalid="InvalidMsgPass(this);" oninput = "InvalidMsgPass(this);" required>
							<span></span>
						</div>


	
						
					
					</div>
					
					<div class="column">
						

						<input type="FirstName" id="Username" name="FirstName" placeholder="First Name" required oninvalid = "this.setCustomValidity('Please enter username')" onchange = "this.setCustomValidity('')" >

						<input type="LastName" id="LastName" name="LastName" placeholder="Last Name" required>

						<!--Designation: -->
						<div class="txt_field">
							<input type="designation" id="designation" name="designation" placeholder="Designation" required>
							<span></span>
						</div>

						<!--Department: -->
						<div class="txt_field">
							<input type="department" id="Department" name="department" placeholder="Department" required>
							<span></span>
						</div>
	
						<!-- RepeatPassword: -->
						<div class="txt_field">
							<input type="password" id="confirm_password" name="pass-repeat" placeholder="Repeat Password" oninvalid="InvalidMsgPass(this);" oninput = "InvalidMsgPass(this);" required>
							<span></span>
						</div>
	
					</div>
	
				</div>

				<div class="wrapper">

					<div class="captcha-area">
					  <div class="captcha-img">
						<img src= {% static "captcha-bg.png" %} alt="Captch Background">
						<span class="captcha"></span>
					</div>
					<button class="reload-btn"><i class="fas fa-redo-alt"></i></button>
				  </div>
				  <form action="#" class="input-area">
					<input type="text" placeholder="Enter captcha" maxlength="6" spellcheck="false" required>
					<button class="check-btn">Check</button>
				  </form>
				  <div class="status-text"></div>
				</div>
				  <script src="script.js"></script>
	
				<input type="submit" value="SignUp"><br><br>
	

				<div class="signUp_Link">
					Already a member?
					<a href="/home/signIn/">Log In</a>
				</div>
	
				<br>
	
			</form>
			<br>
			<div id="message">
				<h3>Password must contain the following:</h3>
				<p id="letter" class="invalid">A <b>lowercase</b> letter</p>
				<p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
				<p id="number" class="invalid">A <b>number</b></p>
				<p id="length" class="invalid">Minimum <b>8 characters</b></p>
			  </div>

			  <script>
				function InvalidMsg(email) 
				{
				if (email.value === '') {
					email.setCustomValidity('Required email address');
				} else if (email.validity.typeMismatch){
					email.setCustomValidity('please enter a valid email address');
				} else {
				   email.setCustomValidity('');
				}

				return true;
				}
				var myInput = document.getElementById("password");
				  var letter = document.getElementById("letter");
				  var capital = document.getElementById("capital");
				  var number = document.getElementById("number");
				  var length = document.getElementById("length");

				  // When the user clicks on the password field, show the message box
				  myInput.onfocus = function() {
					document.getElementById("message").style.display = "block";
				  }

				  // When the user clicks outside of the password field, hide the message box
				  myInput.onblur = function() {
					document.getElementById("message").style.display = "none";
				  }

				  // When the user starts to type something inside the password field
				  myInput.onkeyup = function() {
					// Validate lowercase letters
					var lowerCaseLetters = /[a-z]/g;
					if(myInput.value.match(lowerCaseLetters)) {  
					  letter.classList.remove("invalid");
					  letter.classList.add("valid");
					} else {
					  letter.classList.remove("valid");
					  letter.classList.add("invalid");
					}
					// Validate capital letters
					var upperCaseLetters = /[A-Z]/g;
					if(myInput.value.match(upperCaseLetters)) {  
					  capital.classList.remove("invalid");
					  capital.classList.add("valid");
					} else {
					  capital.classList.remove("valid");
					  capital.classList.add("invalid");
					}

					// Validate numbers
					var numbers = /[0-9]/g;
					if(myInput.value.match(numbers)) {  
					  number.classList.remove("invalid");
					  number.classList.add("valid");
					} else {
					  number.classList.remove("valid");
					  number.classList.add("invalid");
					}

					// Validate length
					if(myInput.value.length >= 8) {
					  length.classList.remove("invalid");
					  length.classList.add("valid");
					} else {
						length.classList.remove("valid");
					  length.classList.add("invalid");
					}
				  }

				   /* captcha*/
				   const captcha = document.querySelector(".captcha"),
				   reloadBtn = document.querySelector(".reload-btn"),
				   inputField = document.querySelector(".input-area input"),
				   checkBtn = document.querySelector(".check-btn"),
				   statusTxt = document.querySelector(".status-text");
				   //storing all captcha characters in array
				   let allCharacters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O',
									   'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd',
									   'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's',
									   't', 'u', 'v', 'w', 'x', 'y', 'z', 0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
				   function getCaptcha(){
				   for (let i = 0; i < 6; i++) { //getting 6 random characters from the array
					   let randomCharacter = allCharacters[Math.floor(Math.random() * allCharacters.length)];
					   captcha.innerText += ` ${randomCharacter}`; //passing 6 random characters inside captcha innerText
				   }
				   }
				   getCaptcha(); //calling getCaptcha when the page open
				   //calling getCaptcha & removeContent on the reload btn click
				   reloadBtn.addEventListener("click", ()=>{
				   removeContent();
				   getCaptcha();
				   });
				   checkBtn.addEventListener("click", e =>{
					e.preventDefault(); //preventing button from it's default behaviour
					statusTxt.style.display = "block";
					//adding space after each character of user entered values because I've added spaces while generating captcha
					let inputVal = inputField.value.split('').join(' ');
					if(inputVal == captcha.innerText){ //if captcha matched
						statusTxt.style.color = "#4db2ec";
						statusTxt.innerText = "Nice! You don't appear to be a robot.";
						setTimeout(()=>{ //calling removeContent & getCaptcha after 2 seconds
						removeContent();
						getCaptcha();
						}, 2000);
					}else{
						statusTxt.style.color = "#ff0000";
						statusTxt.innerText = "Captcha not matched. Please try again!";
					}
					});
					function removeContent(){
					inputField.value = "";
					captcha.innerText = "";
					statusTxt.style.display = "none";
					}
				</script>
	
		</div>
		
	</body>

</html>